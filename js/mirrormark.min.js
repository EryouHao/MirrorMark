!function(e){"use strict";function t(e,t){var n={theme:"mirrormark",tabSize:"2",indentWithTabs:!0,lineWrapping:!0,extraKeys:{Enter:"newlineAndIndentContinueMarkdownList"},mode:"markdown"};return _.assign(n,t),_.assign(Object.create(i),{element:e,options:n})}!function(e){if("object"==typeof exports&&"object"==typeof module)module.exports=e;else if("function"==typeof define&&define.amd)return define([],e);window&&(window.mirrorMark=e)}(t);var i={render:function(){this.registerKeyMaps(this.keyMaps),this.cm=e.fromTextArea(this.element,this.options),this.options.showToolbar&&this.setToolbar(this.tools)},setToolbar:function(e){var t=document.createElement("ul");t.className=this.options.theme+"-toolbar";var e=this.generateToolList(e);e.forEach(function(e){t.appendChild(e)});var i=this.cm.getWrapperElement();i.parentNode.insertBefore(t,i)},registerKeyMaps:function(e){for(var t in e){if("function"!=typeof this.actions[e[t]])throw"MirrorMark - '"+e[t]+"' is not a registered action";var i={};i[t]=this.actions[e[t]].bind(this),_.assign(this.options.extraKeys,i)}},registerActions:function(e){return _.assign(this.actions,e)},registerTools:function(e,t){for(var i in e)if(this.actions[e[i].action]&&"function"!=typeof this.actions[e[i].action])throw"MirrorMark - '"+e[i].action+"' is not a registered action";return t?void(this.tools=e):void(this.tools=this.tools.concat(e))},generateToolList:function n(e){return e.map(function(e){var t=document.createElement("li"),i=document.createElement("a");if(e.className&&(i.className=e.className),e.showName){var o=document.createTextNode(e.name);i.appendChild(o)}if(e.action&&(i.onclick=function(){this.cm.focus(),this.actions[e.action].call(this)}.bind(this)),t.appendChild(i),e.nested){t.className="has-nested";var r=document.createElement("ul");r.className="mirrormark-toolbar-list";var s=n.call(this,e.nested);s.forEach(function(e){r.appendChild(e)}),t.appendChild(r)}return t}.bind(this))},tools:[{name:"bold",action:"bold",className:"fa fa-bold"},{name:"italicize",action:"italicize",className:"fa fa-italic"},{name:"blockquote",action:"blockquote",className:"fa fa-quote-left"},{name:"link",action:"link",className:"fa fa-link"},{name:"image",action:"image",className:"fa fa-image"},{name:"unorderedList",action:"unorderedList",className:"fa fa-list"},{name:"orderedList",action:"orderedList",className:"fa fa-list-ol"}],keyMaps:{"Cmd-B":"bold","Cmd-I":"italicize","Cmd-'":"blockquote","Cmd-Alt-L":"orderedList","Cmd-L":"unorderedList","Cmd-Alt-I":"image","Cmd-H":"hr","Cmd-K":"link"},actions:{bold:function(){this.insertAround("**","**")},italicize:function(){this.insertAround("*","*")},code:function(){this.insertAround("```\r\n","\r\n```")},blockquote:function(){this.insertBefore("> ",2)},orderedList:function(){this.insertBefore("1. ",3)},unorderedList:function(){this.insertBefore("* ",2)},image:function(){this.insertBefore("![](http://)",2)},link:function(){this.insertAround("[","](http://)")},hr:function(){this.insert("---")}},insert:function(e){var t=this.cm.getDoc(),i=t.getCursor();t.replaceRange(e,{line:i.line,ch:i.ch})},insertAround:function(e,t){var i=this.cm.getDoc(),n=i.getCursor();if(i.somethingSelected()){var o=i.getSelection();i.replaceSelection(e+o+t)}else i.replaceRange(e+t,{line:n.line,ch:n.ch}),i.setCursor({line:n.line,ch:n.ch+e.length})},insertBefore:function(e,t){var i=this.cm.getDoc(),n=i.getCursor();if(i.somethingSelected()){var o=i.listSelections();o.forEach(function(n){for(var o=[n.head.line,n.anchor.line].sort(),r=o[0];r<=o[1];r++)i.replaceRange(e,{line:r,ch:0});i.setCursor({line:o[0],ch:t||0})})}else i.replaceRange(e,{line:n.line,ch:0}),i.setCursor({line:n.line,ch:t||0})}}}(window.CodeMirror);