!function(e,t){"use strict";function i(e){var t=e.getWrapperElement();t.className+=" CodeMirror-has-preview",n(t,e)}function n(e,t){var i,n=e.getElementsByClassName("CodeMirror-preview");if(0==n.length){var i=document.createElement("div");i.className="CodeMirror-preview",e.appendChild(i)}else i=n[0];i.innerHTML=a.makeHtml(t.getValue())}function o(e){var t=e.getWrapperElement();t.className=t.className.replace(/\s*CodeMirror-has-preview\b/,""),e.refresh()}var a=new t.Converter;t.Extra.init(a),e.defineOption("preview",!1,function(t,n,a){a==e.Init&&(a=!1),!a!=!n&&(n?i(t):o(t))})}(CodeMirror,Markdown),function(e){"use strict";function t(e,i){if(Array.isArray(i))for(var n=sources.length-1;n>=0;n--)t(e,i[n]);else for(var o in i)e[o]=i[o];return e}function i(e,i){var o={mode:"gfm",theme:"mirrormark",tabSize:"2",indentWithTabs:!0,lineWrapping:!0,autoCloseBrackets:!0,autoCloseTags:!0,showToolbar:!0,extraKeys:{Enter:"newlineAndIndentContinueMarkdownList"}};return t(o,i),t(Object.create(n),{element:e,options:o})}!function(e){if("object"==typeof exports&&"object"==typeof module)module.exports=e;else if("function"==typeof define&&define.amd)return define([],e);window&&(window.mirrorMark=e)}(i);var n={render:function(){this.registerKeyMaps(this.keyMaps),this.cm=e.fromTextArea(this.element,this.options),this.options.showToolbar&&this.setToolbar(this.tools)},setToolbar:function(e){var t=document.createElement("ul");t.className=this.options.theme+"-toolbar";var e=this.generateToolList(e);e.forEach(function(e){t.appendChild(e)});var i=this.cm.getWrapperElement();i.insertBefore(t,i.firstChild)},registerKeyMaps:function(t){for(var i in t){if("function"!=typeof this.actions[t[i]])throw"MirrorMark - '"+t[i]+"' is not a registered action";var n=i.replace("Cmd-",e.keyMap["default"]==e.keyMap.macDefault?"Cmd-":"Ctrl-");this.options.extraKeys[n]=this.actions[t[i]].bind(this)}},registerActions:function(e){return t(this.actions,e)},registerTools:function(e,t){for(var i in e)if(this.actions[e[i].action]&&"function"!=typeof this.actions[e[i].action])throw"MirrorMark - '"+e[i].action+"' is not a registered action";return t?void(this.tools=e):void(this.tools=this.tools.concat(e))},generateToolList:function o(e){return e.map(function(e){var t=document.createElement("li"),i=document.createElement("a");if(t.className=e.name,e.className&&(i.className=e.className),e.showName){var n=document.createTextNode(e.name);i.appendChild(n)}if(e.action&&(i.onclick=function(t){if(this.cm.focus(),this.actions[e.action].call(this),e.toggleClass){var n=i.className.split(" "),o=e.className.split(" "),a=e.toggleClass.split(" ");if(a.push("active"),n.indexOf("active")>=0){var r=a;a=o,o=r}n=n.filter(function(e){return-1===o.indexOf(e)}),[].push.apply(n,a),i.className=n.join(" ")}}.bind(this)),t.appendChild(i),e.nested){t.className+=" has-nested";var a=document.createElement("ul");a.className=this.options.theme+"-toolbar-list";var r=o.call(this,e.nested);r.forEach(function(e){a.appendChild(e)}),t.appendChild(a)}return t}.bind(this))},tools:[{name:"bold",action:"bold",className:"fa fa-bold"},{name:"italicize",action:"italicize",className:"fa fa-italic"},{name:"blockquote",action:"blockquote",className:"fa fa-quote-left"},{name:"strikethrough",action:"strikethrough",className:"fs fa-strikethrough"},{name:"link",action:"link",className:"fa fa-link"},{name:"image",action:"image",className:"fa fa-image"},{name:"unorderedList",action:"unorderedList",className:"fa fa-list"},{name:"orderedList",action:"orderedList",className:"fa fa-list-ol"},{name:"fullScreen",action:"fullScreen",className:"fa fa-expand",toggleClass:"fa fa-compress"},{name:"preview",action:"preview",className:"fa fa-file",toggleClass:"fa fa-file-o"}],keyMaps:{"Cmd-B":"bold","Cmd-I":"italicize","Cmd-'":"blockquote","Cmd-Alt-L":"orderedList","Cmd-L":"unorderedList","Cmd-Alt-I":"image","Cmd-H":"hr","Cmd-K":"link",F11:"fullScreen",Esc:"exitFullScreen"},actions:{bold:function(){this.toggleAround("**","**")},italicize:function(){this.toggleAround("*","*")},strikethrough:function(){this.toggleAround("~~","~~")},code:function(){this.toggleAround("```\r\n","\r\n```")},blockquote:function(){this.toggleBefore("> ")},orderedList:function(){this.toggleBefore("1. ")},unorderedList:function(){this.toggleBefore("* ")},image:function(){this.toggleAround("![","](http://)")},link:function(){this.toggleAround("[","](http://)")},hr:function(){this.insert("---")},fullScreen:function(){this.cm.setOption("fullScreen",!this.cm.getOption("fullScreen"))},exitFullScreen:function(){this.cm.getOption("fullScreen")&&this.cm.setOption("fullScreen",!1)},preview:function(){this.cm.setOption("preview",!this.cm.getOption("preview"))}},insert:function(e){var t=this.cm.getDoc(),i=t.getCursor();t.replaceRange(e,{line:i.line,ch:i.ch})},toggleAround:function(e,t){var i=this.cm.getDoc(),n=i.getCursor();if(i.somethingSelected()){var o=i.getSelection();o.startsWith(e)&&o.endsWith(t)?i.replaceSelection(o.substring(e.length,o.length-t.length),"around"):i.replaceSelection(e+o+t,"around")}else i.replaceRange(e+t,{line:n.line,ch:n.ch}),i.setCursor({line:n.line,ch:n.ch+e.length})},toggleBefore:function(e){var t=this.cm.getDoc(),i=t.getCursor();if(t.somethingSelected()){var n=t.listSelections(),o=null;this.cm.operation(function(){n.forEach(function(i){var n=[i.head.line,i.anchor.line].sort();null==o&&(o=t.getLine(n[0]).startsWith(e));for(var a=n[0];a<=n[1];a++)o?t.getLine(a).startsWith(e)&&t.replaceRange("",{line:a,ch:0},{line:a,ch:e.length}):t.replaceRange(e,{line:a,ch:0})})})}else{var a=i.line;t.getLine(a).startsWith(e)?t.replaceRange("",{line:a,ch:0},{line:a,ch:e.length}):t.replaceRange(e,{line:a,ch:0})}}}}(window.CodeMirror);